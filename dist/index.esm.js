import{EventEmitter as e}from"events";import t,{useRef as n,useCallback as r,useEffect as o}from"react";import{ResponsiveContainer as a,LineChart as s,CartesianGrid as i,XAxis as l,YAxis as c,Tooltip as m,Line as u}from"recharts";import*as p from"d3";import{Tooltip as d,IconButton as h}from"@mui/material";import g from"@mui/icons-material/Settings";class v{constructor(){}static getInstance(){return v.instance||(v.instance=new v),v.instance}analyze(){return{components:[],unusedProps:[],propPatterns:[],frequentUpdates:[]}}}class _ extends e{constructor(e={}){super(),this.isMonitoring=!1,this.metrics={latencies:[],errors:0,totalRequests:0,timestamps:[]},this.eventHistory=[],this.sampleInterval=e.sampleInterval||1e3,this.warningThreshold=e.warningThreshold||1e3,this.errorThreshold=e.errorThreshold||5e3,this.setMaxListeners(100)}static getInstance(e={}){return _.instance||(_.instance=new _(e)),_.instance}start(){this.isMonitoring||(this.isMonitoring=!0,this.emit("monitoring:started"),this.startMonitoring())}stop(){this.isMonitoring&&(this.isMonitoring=!1,this.emit("monitoring:stopped"))}subscribe(e){return this.on("monitoring-event",e),()=>this.unsubscribe(e)}unsubscribe(e){this.off("monitoring-event",e)}startMonitoring(){this.isMonitoring||(this.isMonitoring=!0,this.eventHistory=[])}stopMonitoring(){this.isMonitoring=!1}trackPropUpdate(e,t,n){if(!this.isMonitoring)return;const r={type:"prop-update",componentName:e,timestamp:Date.now(),data:{propName:t,propValue:n}};this.eventHistory.push(r),this.emit("monitoring-event",r)}trackRender(e,t){if(!this.isMonitoring)return;const n={type:"render",componentName:e,timestamp:Date.now(),data:{renderDuration:t}};this.eventHistory.push(n),this.emit("monitoring-event",n)}trackError(e,t){if(!this.isMonitoring)return;const n={type:"error",componentName:e,timestamp:Date.now(),data:{error:t}};this.eventHistory.push(n),this.emit("monitoring-event",n)}trackUpdate(e,t){if(!this.isMonitoring)return;const n={type:"update",componentName:e,timestamp:Date.now(),data:{message:t}};this.eventHistory.push(n),this.emit("monitoring-event",n)}trackWarning(e,t){if(!this.isMonitoring)return;const n={type:"warning",componentName:e,timestamp:Date.now(),data:{message:t}};this.eventHistory.push(n),this.emit("monitoring-event",n)}getEventHistory(){return[...this.eventHistory]}clearEventHistory(){this.eventHistory=[]}collectPerformanceMetrics(){const e=performance.getEntriesByType("measure"),t=e.map((e=>e.duration)),n=e.filter((e=>e.duration>this.errorThreshold)).length,r=e.length;return{latencies:t,errors:n,totalRequests:r,timestamps:this.metrics.timestamps,averageLatency:t.reduce(((e,t)=>e+t),0)/t.length,errorRate:n/r,throughput:r/(this.sampleInterval/1e3)}}checkViolations(e){const t=e.averageLatency||0;t>this.errorThreshold?this.emit("monitoring:violation",{type:"error",message:`Average latency (${t}ms) exceeds error threshold (${this.errorThreshold}ms)`}):t>this.warningThreshold&&this.emit("monitoring:violation",{type:"warning",message:`Average latency (${t}ms) exceeds warning threshold (${this.warningThreshold}ms)`})}}var b={container:"base-module_container__N-VTj","node-component":"base-module_node-component__3R2-B","node-prop":"base-module_node-prop__6bpoO","link-dependency":"base-module_link-dependency__t58B6","link-update":"base-module_link-update__fj1Pw",chartContainer:"base-module_chartContainer__lcs0d",tooltip:"base-module_tooltip__c9I89",performanceHigh:"base-module_performanceHigh__Hnxwi",performanceMedium:"base-module_performanceMedium__jYlB7",performanceLow:"base-module_performanceLow__RWfP-",section:"base-module_section__l0hua","section-title":"base-module_section-title__GYBoP","section-content":"base-module_section-content__s8HOk",button:"base-module_button__yooH5",buttonActive:"base-module_buttonActive__yBKXk",dataGrid:"base-module_dataGrid__cMCBW",dataItem:"base-module_dataItem__S-ukG",dataLabel:"base-module_dataLabel__-otSE",dataValue:"base-module_dataValue__wYuSW"};const f=({data:e})=>{const a=n(null),s=n(),i=r((()=>{a.current&&s.current&&p.select(a.current).transition().duration(750).call(s.current.transform,p.zoomIdentity)}),[]);return o((()=>{if(!a.current)return;p.select(a.current).selectAll("*").remove();const t=e.components.map((e=>({id:e.componentName,group:1}))),n=e.propPatterns.flatMap((e=>"dependent"!==e.type?[]:e.components.flatMap((t=>e.components.filter((e=>e!==t)).map((e=>({source:t,target:e,value:1}))))))),r=p.select(a.current).attr("width",800).attr("height",600),o=p.zoom().scaleExtent([.1,4]).on("zoom",(e=>{r.selectAll("g").attr("transform",e.transform.toString())}));s.current=o,r.call(o);const i=p.forceSimulation(t).force("link",p.forceLink(n).id((e=>e.id))).force("charge",p.forceManyBody()).force("center",p.forceCenter(400,300)),l=r.append("g").selectAll("line").data(n).join("line").attr("stroke","#999").attr("stroke-opacity",.6).attr("stroke-width",(e=>Math.sqrt(e.value))),c=r.append("g").selectAll("circle").data(t).join("circle").attr("r",5).attr("fill","#69b3a2").call(p.drag().on("start",(function(e){e.active||i.alphaTarget(.3).restart();e.subject.fx=e.subject.x,e.subject.fy=e.subject.y})).on("drag",(function(e){e.subject.fx=e.x,e.subject.fy=e.y})).on("end",(function(e){e.active||i.alphaTarget(0);e.subject.fx=null,e.subject.fy=null})));return c.append("title").text((e=>e.id)),i.on("tick",(()=>{l.attr("x1",(e=>{var t;return null!==(t=e.source.x)&&void 0!==t?t:0})).attr("y1",(e=>{var t;return null!==(t=e.source.y)&&void 0!==t?t:0})).attr("x2",(e=>{var t;return null!==(t=e.target.x)&&void 0!==t?t:0})).attr("y2",(e=>{var t;return null!==(t=e.target.y)&&void 0!==t?t:0})),c.attr("cx",(e=>{var t;return null!==(t=e.x)&&void 0!==t?t:0})).attr("cy",(e=>{var t;return null!==(t=e.y)&&void 0!==t?t:0}))})),()=>{i.stop()}}),[e]),t.createElement("div",{className:b["component-relationship"]},t.createElement("h3",null,"Component Relationships"),t.createElement("div",{className:b["relationship-controls"]},t.createElement("button",{className:b.button,onClick:i},"Reset View")),t.createElement("div",{className:b["relationship-legend"]},t.createElement("div",{className:b["legend-item"]},t.createElement("span",{className:b["legend-color"],style:{backgroundColor:"#4caf50"}}),t.createElement("span",null,"Component")),t.createElement("div",{className:b["legend-item"]},t.createElement("span",{className:b["legend-color"],style:{backgroundColor:"#2196f3"}}),t.createElement("span",null,"Prop"))),t.createElement("svg",{ref:a,width:800,height:600,className:b["relationship-svg"]}))},y=({data:e})=>{const n=e.components.flatMap((e=>e.props.map((t=>({name:`${e.componentName}.${t.name}`,time:t.timestamps[t.timestamps.length-1]||0,value:t.lastValue,updates:t.valueChanges||0})))));return t.createElement("div",{style:{width:"100%",height:400}},t.createElement(a,null,t.createElement(s,{data:n},t.createElement(i,{strokeDasharray:"3 3"}),t.createElement(l,{dataKey:"time"}),t.createElement(c,null),t.createElement(m,null),t.createElement(u,{type:"monotone",dataKey:"updates",stroke:"#8884d8"}))))};function k({onClick:e,tooltipPlacement:n="bottom",tooltipTitle:r="Developer Tools - Task & Feature Analysis"}){return t.createElement(d,{title:r,arrow:!0,placement:n},t.createElement(h,{"aria-label":"Developer Tools",color:"primary",onClick:e,sx:{backgroundColor:"rgba(0, 0, 0, 0.4)","&:hover":{backgroundColor:"rgba(59, 130, 246, 0.2)",boxShadow:"0 0 12px rgba(59, 130, 246, 0.3)"},boxShadow:"0 0 8px rgba(59, 130, 246, 0.2)"}},t.createElement(g,null)))}export{f as ComponentRelationship,k as DevToolsButton,_ as MonitoringService,v as PropAnalyzer,y as PropTimeline};
//# sourceMappingURL=index.esm.js.map
